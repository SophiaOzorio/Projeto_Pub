<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pr√°ticas</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      padding-top: 70px;
      font-family: "Inter", sans-serif;
      background-color: #f8f9fa;
    }

    /* Navbar */
    .nav-link {
      font-weight: 500;
      margin: 0 1rem;
      color: #333;
      transition: color 0.2s, border-bottom 0.2s;
    }

    .nav-link:hover {
      color: #007bff;
    }

    .nav-link.active {
      color: #007bff;
      border-bottom: 2px solid #007bff;
    }

    /* Accordion */
    .accordion-button {
      background-color: #f8f9fa;
      color: #0d1b2a;
      font-size: 1.1rem;
      border-radius: 0.75rem !important;
      transition: all 0.2s ease;
    }

    .accordion-button:not(.collapsed) {
      background-color: #eaf0ff;
      color: #0044cc;
      box-shadow: none;
    }

    .accordion-button::after {
      transform: rotate(0deg);
      transition: transform 0.2s ease;
    }

    .accordion-button:not(.collapsed)::after {
      transform: rotate(90deg);
    }

    .accordion-body {
      background-color: #ffffff;
      border-radius: 0 0 0.75rem 0.75rem;
      padding: 1.25rem 1.5rem;
      color: #333;
    }

    h1 {
      font-weight: 700;
      color: #0d1b2a;
      margin-bottom: 1rem;
    }

    p {
      color: #555;
    }

  .code-container {
    background-color: #1e1e1e; /* fundo escuro */
    border-radius: 8px;
    padding: 16px;
    position: relative;
    overflow-x: auto;
    margin-top: 10px;
  }

  .code-container pre {
    margin: 0;
    font-family: 'Fira Code', monospace;
    font-size: 14px;
    color: #e0e0e0;
  }

  .copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: none;
    border: none;
    color: #888;
    cursor: pointer;
    font-size: 16px;
  }

  .copy-btn:hover {
    color: #ffffff;
  }
  </style>
</head>

<body>

  <!-- Navbar centralizada -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
    <div class="container justify-content-center">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="desenvolvimento.html">Desenvolvimento</a></li>
          <li class="nav-item"><a class="nav-link active" href="praticas.html">Atividades</a></li>
          <li class="nav-item"><a class="nav-link" href="referencia.html">Refer√™ncias</a></li>
          <li class="nav-item"><a class="nav-link" href="autores.html">Autores</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Se√ß√£o principal -->
  <section class="container py-5">
    <h1 class="fw-bold">Atividades</h1>
    <p class="text-secondary mb-4">Selecione uma atividade abaixo para visualizar seu conte√∫do.</p>

    <!-- Accordion √∫nico para todas as pr√°ticas -->
    <div class="accordion" id="accordionAtividades">

      <!-- Pr√°tica 0 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade0"
                  aria-expanded="false" aria-controls="collapseAtividade0">
            PREPARA√á√ÉO DOS AMBIENTES CONDA
          </button>
        </h2>
        <div id="collapseAtividade0" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
<p><strong>O que √© ambiente conda?</strong></p>
              <li> Um ambiente Conda √© um espa√ßo isolado dentro do gerenciador de pacotes Conda (usado no Anaconda ou Miniconda) que permite instalar e gerenciar vers√µes espec√≠ficas de pacotes, bibliotecas e depend√™ncias sem interferir em outros projetos.</li>
              <li> Uma boa pr√°tica √© utilizar um ambiente conda para cada etapa no processamento dos dados.</li><br>
            <p><strong>Como usar?</strong></p><br>
    <p><strong>1. Instalar Conda</strong></p>
  <ul>
    <li>Baixar e instalar <strong>Anaconda</strong> (completo) ou <strong>Miniconda</strong> (mais leve).</li>
    <li>Verificar instala√ß√£o:
      <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
        <pre><code>conda --version</code></pre>
      </div>
    </li>
  </ul>

  <p><strong>2. Criar um ambiente</strong></p>
  <ul>
    <li>Criar ambiente com nome espec√≠fico e vers√£o do Python desejada:
      <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
        <pre><code>conda create -n meu_ambiente python=3.11</code></pre>
      </div>
    </li>
  </ul>

  <p><strong>3. Ativar e desativar ambiente</strong></p>
  <ul>
    <li>Ativar ambiente:
      <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
        <pre><code>conda activate meu_ambiente</code></pre>
      </div>
    </li>
    <li>Desativar ambiente:
      <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
        <pre><code>conda deactivate</code></pre>
      </div>
    </li>
  </ul>

  <p><strong>4. Instalar pacotes</strong></p>
  <p>‚ö†Ô∏è Nesta etapa, pesquise no Google o nome da ferramenta necess√°ria seguido de <code>conda install</code> para cada atividade. Exemplo: <code>fastqc conda install</code>. Dessa forma, voc√™ descobrir√° como instalar a ferramenta via Conda, incluindo todas as depend√™ncias necess√°rias.</p>
  <p>‚ö†Ô∏è Certifique-se de instalar as ferramentas apenas com o ambiente Conda desejado ativo!</p>
  <ul>
    <li>Instalar pacotes dentro do ambiente ativo:
      <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
        <pre><code>conda install numpy pandas</code></pre>
      </div>
    </li>
    <li>Instalar de canais espec√≠ficos (ex.: conda-forge):
      <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
        <pre><code>conda install -c conda-forge pacote</code></pre>
      </div>
    </li>
  </ul>
          </div>
        </div>
      </div>


      <!-- Pr√°tica 1 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade1"
                  aria-expanded="false" aria-controls="collapseAtividade1">
            Atividade 1 ‚Äî Defini√ß√£o do Problema
          </button>
        </h2>
        <div id="collapseAtividade1" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Iniciar o desenvolvimento do projeto. Aqui, voc√™ ir√° estruturar a base do estudo, identificando o que ser√° investigado.</p> 
            <p><strong>Pergunta Norteadora:</strong> Quais genes est√£o relacionados ao desenvolvimento do c√¢ncer de mama heredit√°rio? (Se o aluno j√° estiver investigando outra doen√ßa, a an√°lise pode ser adaptada para o tema escolhido.)</p>
          </div>
        </div>
      </div>

      <!-- Pr√°tica 2 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade2"
                  aria-expanded="false" aria-controls="collapseAtividade2">
            Atividade 2 ‚Äî Busca na Literatura
          </button>
        </h2>
        <div id="collapseAtividade2" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Realizar uma pesquisa bibliogr√°fica sobre o tema do projeto para compreender o que j√° foi estudado, identificar lacunas e fundamentar cientificamente a proposta.</p>
            <p><strong>Tarefa:</strong></p>
            <ol>
              <li>Busque artigos e revis√µes recentes (√∫ltimos 5 anos) em bases cient√≠ficas como:  
                <ul>
                  <li><a href="https://pubmed.ncbi.nlm.nih.gov/" target="_blank">PubMed</a></li>
                  <li><a href="https://www.scielo.org/" target="_blank">SciELO</a></li>
                  <li><a href="https://scholar.google.com/" target="_blank">Google Scholar</a></li>
                </ul>
               </li>
              <li>Elabore um par√°grafo integrando os achados e explicando como eles justificam e contribuem para o desenvolvimento do seu projeto.</li>
            </ol>
            <p><strong>üí° Dica:</strong> Aproveite para buscar estudos que adotem metodologias semelhantes √† do seu projeto (como a an√°lise de exoma germinativo) e que disponibilizem seus dados em bancos p√∫blicos de acesso aberto.</p>
          </div>
        </div>
      </div>

      <!-- Pr√°tica 3 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade3"
                  aria-expanded="false" aria-controls="collapseAtividade3">
            Atividade 3 ‚Äî Download dos Dados
          </button>
        </h2>
        <div id="collapseAtividade3" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Baixar os dados necess√°rios para o projeto.</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Com base nos dados encontrados durante a busca liter√°ria, acesse o banco onde os mesmos foram disponibilizados, encontre o c√≥digo <strong>SRA</strong> e execute o seguinte comando para baixar:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>/CAMINHO/PARA/O/EXECUT√ÅVEL/prefetch SRRXXXXXX SRRYYYYYY SRRZZZZZZ</code></pre>
            </div>
            
            <p><strong>2 -</strong> Ap√≥s baixar os dados .SRA, √© necess√°rio transform√°-los para o formato <strong>FASTQ</strong>. Para isso, use o seguinte comando (para dados paired-end):</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>/CAMINHO/PARA/O/EXECUT√ÅVEL/fastq-dump --splites-files --progress --outdir /CAMINHO/DE/SAIDA/DOS/ARQUIVOS/GERADOS/</code></pre>
              <p># Caso suas amostras sejam single-end n√£o use o par√¢metro "--splites-files"</p>
            </div>

            <p><strong>üí° Dica:</strong> Fa√ßa pastas separadas para armazenar os outputs de passo da pipeline!</p>
          </div>
        </div>
      </div>

      <!-- Pr√°tica 4 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade4"
                  aria-expanded="false" aria-controls="collapseAtividade4">
            Atividade 4 ‚Äî Controle de Qualidade
          </button>
        </h2>
        <div id="collapseAtividade4" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Realizar e analisar o controle de qualidade das amostras baixadas no passo anterior.</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Tendo os arquivos FASTQ das amostras selecionadas, utilizaremos a ferramenta FastQC, para gerar os relat√≥rios de controle de qualidade, executando o seguinte comando:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>fastqc amostra_A_R1.fastq.gz amostra_A_R2.fastq.gz amostra_B_R1.fastq.gz amostra_B_R2.fastq.gz</code></pre>
            </div><br>

            <p><strong>2 -</strong> Ap√≥s realizar o controle de qualidade com a ferramenta FastQC, utilizaremos a ferramenta MultiQC para integrar os resultados de todas as amostras em somente um gr√°fico. Para isso, execute o seguinte comando:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>multiqc .</code></pre>
              <p># V√° para o diret√≥rio que cont√©m os arquivos que voc√™ deseja analisar com o MultiQC.<br>
              # A entrada ser√£o os arquivos gerados pelo FastQC ".fastq.gz"</p>
            </div><br>

            <p><strong>3 -</strong> Analise os resultados obtidos, com auxilio do material te√≥rico na aba "Desenvolvimento", m√≥dulo "4 - Controle de Qualidade".</p>

          </div>
        </div>
      </div>


      <!-- Pr√°tica 5 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade5"
                  aria-expanded="false" aria-controls="collapseAtividade5">
            Atividade 5 ‚Äî Trimagem
          </button>
        </h2>
        <div id="collapseAtividade5" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Efetuar a remo√ß√£o dos adaptadores e o corte das bases de baixa qualidade, se necess√°rio.</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Ap√≥s revisar os resultados do passo anterior, verifique se √© necess√°rio executar a trimagem para remover adaptadores e bases de baixa qualidade. Caso necess√°rio, execute esse coomando no terminal do servidor:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>/CAMINHO/PARA/O/EXECUT√ÅVEL/trim_galore -j 24 -q 10 --phred33 --length 35 --paired --retain_unpaired -o /CAMINHO/PARA/OS/OUTPUTS/ amostra_A_R1.fastq.gz amostra_A_R2.fastq.gz</code></pre>
              <p># Significado Par√¢metros:</p>
              <p># -j: Define o n√∫mero de n√∫cleos (cores) de CPU a serem usados.</p>
              <p># -q: Define o limiar m√≠nimo de qualidade Phred. No caso, bases no final de uma leitura com qualidade inferior a 10 ser√£o removidas.</p>
              <p># --phred: Especifica o formato de codifica√ß√£o da qualidade das bases.</p>
              <p># --length: Define o comprimento m√≠nimo que uma leitura deve ter ap√≥s a trimagem para ser mantida.</p>
              <p># --paired: Informa ao programa que os dados de entrada s√£o paired-end.</p>
              <p># --retain_unpaired: Mant√©m leituras cujo par foi descartado em arquivos separados.</p>
            </div><br>

            <p><strong>2 -</strong> Caso suas amostras tenham sido trimadas, repita a atividade 4. O objetivo √© garantir que a qualidade dos dados √© adequada para dar continuidade √† an√°lise.</p>
          </div>
        </div>
      </div>

            <!-- Pr√°tica 6 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade6"
                  aria-expanded="false" aria-controls="collapseAtividade6">
            Atividade 6 ‚Äî Alinhamento
          </button>
        </h2>
        <div id="collapseAtividade6" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Determinar a localiza√ß√£o de origem de cada sequ√™ncia curta (read) em um genoma de refer√™ncia.</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Ap√≥s confirmar a qualidade das amostras, iremos realizar a etapa de alinhamento com o genoma de refer√™ncia. Para isso, execute o seguinte comando:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>bwa mem -M -t 24 [/CAMINHO/PARA/O/GENOMA/DE/REFERENCIA/arquivo.fa] [leitura_R1.fastq.gz] [leitura_R2.fastq.gz] > [/CAMINHO/PARA/SAIDA/DOS/OUTPUTS/arquivo_alinhado.sam]¬†</code></pre>
              <p># Significado Par√¢metros:</p>
              <p># -t: Define quantos n√∫cleos de CPU (threads) usar.</p>
              <P># -M: Marca alinhamentos extras como Secund√°rios, evitando poss√≠veis problemas futuros com as pr√≥ximas ferramentas.</P>
            </div><br>

            <p><strong>2 - </strong>A ferramenta de alinhamento BWA gera sa√≠das no formato SAM. No entanto, para as etapas subsequentes da an√°lise, √© necess√°ria a convers√£o desses arquivos para o formato BAM. Para isso, execute o seguinte comando:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre>
                <p># Converter o arquivo SAM para BAM</p><code>samtools view -Sb [/CAMINHO/AMOSTRA/SAM/amostra.sam] > [/CAMINHO/PARA/ARQUIVO/SAIDA/amostra.bam]<br>
                <p># Ordenar o arquivo BAM</p>samtools sort -@ 24 -o [/CAMINHO/PARA/OUTPUTS/amostra.sorted.bam] [/CAMINHO/PARA/OS/ARQUIVOS/GERADOS/ANTERIORMENTE/amostra.bam]</code>
              </pre>
            </div>
          </div>
        </div>
      </div>

    <!-- Pr√°tica 7 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade7"
                  aria-expanded="false" aria-controls="collapseAtividade7">
            Atividade 7 ‚Äî Boas Pr√°ticas GATK
          </button>
        </h2>
        <div id="collapseAtividade7" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Efetuar etapas para que garantem a qualidade das amostras.</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Primeiramente, iremos marcar as duplicatas com a ferramenta "Picard", usando o seguinte script: </p>
            
        <div class="code-container">
        <button class="copy-btn" onclick="copyCode(this)">üìã</button>
                    <pre><code id="code-block" class="language-bash"><span class="keyword">#!/bin/bash</span>

<span class="comment"># --- Configure seus caminhos aqui ---</span>
<span class="variable">INPUT_DIR</span>=<span class="string">"/caminho/para/seus/bams"</span>
<span class="variable">OUTPUT_DIR</span>=<span class="string">"/caminho/para/salvar/resultados"</span>
<span class="variable">PICARD_JAR</span>=<span class="string">"/caminho/para/seu/picard.jar"</span>
<span class="variable">MEMORY</span>=<span class="string">"30g"</span>
<span class="comment"># --- Fim da configura√ß√£o ---</span>

<span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="string">"$INPUT_DIR"</span>/*.bam; <span class="keyword">do</span>
    <span class="variable">base</span>=<span class="operator">$(</span><span class="command">basename</span> <span class="string">"$i"</span><span class="operator">)</span>
    <span class="variable">prefix</span>=<span class="string">"${base%%.bam}"</span>
    <span class="variable">out</span>=<span class="string">"${OUTPUT_DIR}/${prefix}.rmdup.bam"</span>
    <span class="variable">met</span>=<span class="string">"${OUTPUT_DIR}/${prefix}.metrics"</span>
    <span class="command">java</span> -Xmx<span class="string">"$MEMORY"</span> -jar <span class="string">"$PICARD_JAR"</span> MarkDuplicates METRICS_FILE=<span class="string">"$met"</span> I=<span class="string">"$i"</span> O=<span class="string">"$out"</span>
<span class="keyword">done</span>
</code></pre>
        </div><br>
        <p><strong>üí° Importante!</strong> Configure as vari√°veis: edite a se√ß√£o de configura√ß√£o no topo do script para apontar para os diret√≥rios e arquivos corretos do seu projeto.</p><br>

          <p><strong>2 - </strong>Agora, iremos recalibrar a qualidade de bases com "GATK BaseRecalibrator", usando o seguinte script: </p>
          <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">üìã</button>
<pre><code><span class="comment">#!/bin/bash</span>

<span class="comment"># ===================================================================</span>
<span class="comment"># 1. DEFINI√á√ÉO DE VARI√ÅVEIS E CAMINHOS</span>
<span class="comment"># Altere os caminhos abaixo para corresponder √† sua estrutura de diret√≥rios.</span>
<span class="comment"># ===================================================================</span>

<span class="comment"># Diret√≥rio contendo os arquivos BAM de entrada (p√≥s-marca√ß√£o de duplicatas)</span>
<span class="variable">DIR_DUPLICATAS</span>=<b>'/CAMINHO/PARA/ARQUIVOS/BAM/DE/ENTRADA/'</b>

<span class="comment"># Diret√≥rio onde os arquivos de sa√≠da (tabela de recalibra√ß√£o e BAM recalibrado) ser√£o salvos</span>
<span class="variable">DIR_OUTPUT</span>=<b>'/CAMINHO/PARA/DIRETORIO/DE/SAIDA/'</b>

<span class="comment"># Arquivo do genoma de refer√™ncia em formato FASTA</span>
<span class="variable">REFHG38</span>=<b>'/CAMINHO/PARA/GENOMA/DE/REFERENCIA/hg38.fa'</b>

<span class="comment"># Arquivos de "known sites" (variantes conhecidas) para o GATK</span>
<span class="variable">KNOWIND</span>=<b>'/CAMINHO/PARA/ARQUIVOS/VCF/Homo_sapiens_assembly38.known_indels.vcf.gz'</b>
<span class="variable">KNOWSNP</span>=<b>'/CAMINHO/PARA/ARQUIVOS/VCF/Homo_sapiens_assembly38.dbsnp138.vcf.gz'</b>
<span class="variable">KNOWMIND</span>=<b>'/CAMINHO/PARA/ARQUIVOS/VCF/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz'</b>

<span class="comment"># ===================================================================</span>
<span class="comment"># 2. PREPARA√á√ÉO DO AMBIENTE</span>
<span class="comment"># ===================================================================</span>

<span class="comment"># Cria o diret√≥rio de sa√≠da se ele ainda n√£o existir</span>
<span class="command">mkdir</span> -p ${<span class="variable">DIR_OUTPUT</span>}

<span class="comment"># Navega para o diret√≥rio com os arquivos de entrada para simplificar os loops</span>
<span class="command">cd</span> ${<span class="variable">DIR_DUPLICATAS</span>}

<span class="comment"># ===================================================================</span>
<span class="comment"># ETAPA 1: Gerar a tabela de recalibra√ß√£o com BaseRecalibrator</span>
<span class="comment"># ===================================================================</span>
echo "Iniciando a etapa 1: BaseRecalibrator..."

<span class="comment"># O loop identifica o prefixo de cada amostra a partir dos arquivos *.rmdup.bam</span>
<span class="command">for</span> i in $(ls -1 rmdup.bam | sed 's/.rmdup.bam//'); <span class="command">do</span>
  echo "Processando amostra: ${i}"
  <span class="command">gatk</span> --java-options "-Xmx60G -XX:ParallelGCThreads=24" BaseRecalibrator
    -I ${i}.rmdup.bam
    -R ${<span class="variable">REFHG38</span>}
    --known-sites ${<span class="variable">KNOWIND</span>}
    --known-sites ${<span class="variable">KNOWSNP</span>}
    --known-sites ${<span class="variable">KNOWMIND</span>}
    -O ${<span class="variable">DIR_OUTPUT</span>}/${i}.recal_data.table;
<span class="command">done</span>

echo "Etapa 1 conclu√≠da."

<span class="comment"># ===================================================================</span>
<span class="comment"># ETAPA 2: Aplicar a recalibra√ß√£o nos arquivos BAM com ApplyBQSR</span>
<span class="comment"># ===================================================================</span>
echo "Iniciando a etapa 2: ApplyBQSR..."

<span class="command">for</span> i in $(ls -1 rmdup.bam | sed 's/.rmdup.bam//'); <span class="command">do</span>
  echo "Aplicando BQSR na amostra: ${i}"
  <span class="command">gatk</span> --java-options "-Xmx60G -XX:ParallelGCThreads=24" ApplyBQSR
    -R ${<span class="variable">REFHG38</span>}
    -I ${i}.rmdup.bam
    --bqsr-recal-file ${<span class="variable">DIR_OUTPUT</span>}${i}.recal_data.table
    -O ${<span class="variable">DIR_OUTPUT</span>}/${i}.recal.bam;
<span class="command">done</span>

echo "Processo de recalibra√ß√£o finalizado com sucesso!"
</code></pre><br>
          </div><br>
            <p><strong>üí° Importante!</strong> Configure as vari√°veis: edite a se√ß√£o de configura√ß√£o no topo do script para apontar para os diret√≥rios e arquivos corretos do seu projeto.</p>
          </div>
        </div>
      </div>

          <!-- Pr√°tica 8 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade8"
                  aria-expanded="false" aria-controls="collapseAtividade8">
            Atividade 8 ‚Äî Chamada de Variantes
          </button>
        </h2>
        <div id="collapseAtividade8" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Realizar a detec√ß√£o e genotipagem de variantes gen√©ticas (SNPs e indels) a partir dos arquivos em formato BAM, identificando diferen√ßas entre as sequ√™ncias do genoma amostrado e o genoma de refer√™ncia.</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Utilizando a ferramenta GATK HaplotypeCaller, ser√° realizada a etapa de chamada de variantes, conforme o script apresentado a seguir:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>
<span class="comment"># --- CONFIGURA√á√ÉO: EDITE AS VARI√ÅVEIS ABAIXO ---</span>
<span class="comment"># ‚öôÔ∏è Modifique estas vari√°veis para se adequarem ao seu projeto.</span>
<span class="comment"># 1. Arquivos de Refer√™ncia</span>
<span class="variable">REFERENCE_GENOME</span>=<span class="string">"/caminho/para/seu/genoma_referencia.fasta"</span>
<span class="comment"># 2. Diret√≥rio contendo os arquivos BAM recalibrados (sa√≠da do ApplyBQSR).</span>
<span class="variable">INPUT_BAM_DIR</span>=<span class="string">"/caminho/para/seus/bams_recalibrados"</span>
<span class="comment"># 3. Diret√≥rio principal onde todos os resultados ser√£o salvos.</span>
<span class="variable">OUTPUT_DIR</span>=<span class="string">"/caminho/para/salvar/os/resultados_finais"</span>
<span class="comment"># 4. Mem√≥ria a ser alocada para o Java (ex: 100g para 100 gigabytes).</span>
<span class="variable">MEMORY</span>=<span class="string">"100g"</span>
<span class="comment"># --- FIM DA CONFIGURA√á√ÉO ---</span>


<span class="comment"># --- L√ìGICA DO SCRIPT (N√ÉO PRECISA EDITAR) ---</span>

<span class="comment"># Garante que o script pare se algum comando falhar.</span>
<span class="keyword">set</span> -e

<span class="comment"># Define os nomes dos subdiret√≥rios de sa√≠da</span>
<span class="variable">VARCALL_DIR</span>=<span class="string">"${OUTPUT_DIR}/1_variant_calling_gvcfs"</span>
<span class="variable">FILTERED_DIR</span>=<span class="string">"${OUTPUT_DIR}/2_vcf_filtered"</span>
<span class="variable">FINAL_DIR</span>=<span class="string">"${OUTPUT_DIR}/3_vcf_final"</span>

<span class="keyword">echo</span> <span class="string">">>> Criando diret√≥rios de sa√≠da..."</span>
<span class="command">mkdir</span> -p <span class="string">"$VARCALL_DIR"</span> <span class="string">"$FILTERED_DIR"</span> <span class="string">"$FINAL_DIR"</span>

<span class="comment"># --- PASSO 1: HaplotypeCaller (Modo GVCF) ---</span>
<span class="keyword">echo</span> <span class="string">">>> PASSO 1: Executando HaplotypeCaller para cada amostra..."</span>
<span class="keyword">for</span> <span class="variable">input_bam</span> <span class="keyword">in</span> <span class="string">"$INPUT_BAM_DIR"</span>/*.recal.bam; <span class="keyword">do</span>
    <span class="variable">prefix</span>=<span class="string">$(</span><span class="command">basename</span> <span class="string">"${input_bam}"</span> .recal.bam<span class="string">)</span>
    <span class="keyword">echo</span> <span class="string">"--> Processando amostra: $prefix"</span>
    
    <span class="command">gatk</span> --java-options <span class="string">"-Xmx${MEMORY}"</span> HaplotypeCaller \
        <span class="flag">-R</span> <span class="string">"$REFERENCE_GENOME"</span> \
        <span class="flag">-I</span> <span class="string">"$input_bam"</span> \
        <span class="flag">-O</span> <span class="string">"${VARCALL_DIR}/${prefix}.g.vcf.gz"</span> \
        <span class="flag">-ERC</span> GVCF
    <span class="keyword">done</span>

<span class="comment"># --- PASSO 2: GenotypeGVCFs (Combinar amostras) ---</span>
<span class="keyword">echo</span> <span class="string">">>> PASSO 2: Combinando GVCFs com GenotypeGVCFs..."</span>
<span class="command">gatk</span> --java-options <span class="string">"-Xmx${MEMORY}"</span> GenotypeGVCFs \
    <span class="flag">-R</span> <span class="string">"$REFERENCE_GENOME"</span> \
    <span class="string">"${VARCALL_DIR}/*.g.vcf.gz"</span> \
    <span class="flag">-O</span> <span class="string">"${FILTERED_DIR}/cohort_genotyped.vcf.gz"</span>

<span class="comment"># --- PASSO 3: VariantFiltration ---</span>
<span class="keyword">echo</span> <span class="string">">>> PASSO 3: Aplicando filtros de qualidade (VariantFiltration)..."</span>
<span class="command">gatk</span> --java-options <span class="string">"-Xmx${MEMORY}"</span> VariantFiltration \
    <span class="flag">-R</span> <span class="string">"$REFERENCE_GENOME"</span> \
    <span class="flag">-V</span> <span class="string">"${FILTERED_DIR}/cohort_genotyped.vcf.gz"</span> \
    <span class="flag">-O</span> <span class="string">"${FILTERED_DIR}/cohort_genotyped_filtered.vcf.gz"</span> \
    <span class="flag">--filter-expression</span> <span class="string">"QD < 2.0"</span> <span class="flag">--filter-name</span> <span class="string">"QD2"</span> \
    <span class="flag">--filter-expression</span> <span class="string">"FS > 60.0"</span> <span class="flag">--filter-name</span> <span class="string">"FS60"</span> \
    <span class="flag">--filter-expression</span> <span class="string">"MQ < 40.0"</span> <span class="flag">--filter-name</span> <span class="string">"MQ40"</span> \
    <span class="flag">--filter-expression</span> <span class="string">"SOR > 5.0"</span> <span class="flag">--filter-name</span> <span class="string">"SOR5"</span> \
    <span class="flag">--filter-expression</span> <span class="string">"MQRankSum < -12.5"</span> <span class="flag">--filter-name</span> <span class="string">"MQRankSum-12.5"</span> \
    <span class="flag">--filter-expression</span> <span class="string">"ReadPosRankSum < -8.0"</span> <span class="flag">--filter-name</span> <span class="string">"ReadPosRankSum-8"</span>

<span class="comment"># --- PASSO 4: SelectVariants (Manter apenas variantes PASS) ---</span>
<span class="keyword">echo</span> <span class="string">">>> PASSO 4: Selecionando apenas variantes que passaram nos filtros..."</span>
<span class="command">gatk</span> --java-options <span class="string">"-Xmx${MEMORY}"</span> SelectVariants \
    <span class="flag">-R</span> <span class="string">"$REFERENCE_GENOME"</span> \
    <span class="flag">-V</span> <span class="string">"${FILTERED_DIR}/cohort_genotyped_filtered.vcf.gz"</span> \
    <span class="flag">-O</span> <span class="string">"${FINAL_DIR}/cohort_final_PASS.vcf.gz"</span> \
    <span class="flag">--exclude-filtered</span>

<span class="keyword">echo</span> <span class="string">"Chamada de variantes conclu√≠do! O VCF final est√° em: ${FINAL_DIR}/cohort_final_PASS.vcf.gz"</span>
</code></pre>
        </div><br>
        <p><strong>üí° Importante!</strong> Configure as vari√°veis: edite a se√ß√£o de configura√ß√£o no topo do script para apontar para os diret√≥rios e arquivos corretos do seu projeto.</p>
          </div>
        </div>
      </div>


      <!-- Pr√°tica 9 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade9"
                  aria-expanded="false" aria-controls="collapseAtividade9">
            Atividade 9 ‚Äî Anota√ß√£o das Variantes
          </button>
        </h2>
        <div id="collapseAtividade9" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Realizar a anota√ß√£o funcional das variantes</p>
            <p><strong>Tarefa:</strong> </p>
            <p><strong>1 - </strong>Utilizando as ferramentas SnpEff e SnpSift, realizaremos a anota√ß√£o funcional das variantes. Para isso, execute o script a seguir:</p>
            <div class="code-container">
              <button class="copy-btn" onclick="copyCode(this)">üìã</button>
              <pre><code>
<span class="comment"># --- CONFIGURA√á√ÉO: EDITE AS VARI√ÅVEIS ABAIXO ---</span>
<span class="comment"># ‚öôÔ∏è Modifique estas vari√°veis para se adequarem ao seu ambiente e projeto.</span>

<span class="comment"># 1. Caminhos para as ferramentas</span>
<span class="variable">SNPEFF_JAR</span>=<span class="string">'/caminho/para/share/snpeff-5.2-1/snpEff.jar'</span>
<span class="variable">SNPSIFT_JAR</span>=<span class="string">'/caminho/para/share/snpsift-5.2-0/SnpSift.jar'</span>
<span class="variable">SNPEFF_CONFIG</span>=<span class="string">'/caminho/para/share/snpeff-5.2-1/snpEff.config'</span>
<span class="variable">VCF_EFF_ONE_PER_LINE_PL</span>=<span class="string">'/caminho/para/share/snpeff-5.2-1/scripts/vcfEffOnePerLine.pl'</span>

<span class="comment"># 2. Configura√ß√µes de execu√ß√£o</span>
<span class="variable">MEMORY</span>=<span class="string">'-Xmx32g'</span>
<span class="variable">GENOME_VERSION</span>=<span class="string">'hg38'</span> <span class="comment"># Vers√£o do genoma para SnpEff</span>
<span class="variable">FILTER_PASS_VALUE</span>=1 <span class="comment"># Valor para substituir 'PASS' no final</span>

<span class="comment"># 3. Caminhos para as bases de dados</span>
<span class="variable">DB_CLINVAR</span>=<span class="string">'/caminho/para/db/clinvar.vcf.gz'</span>
<span class="variable">DB_CLINVAR_COMMON</span>=<span class="string">'/caminho/para/db/common_and_clinical.vcf.gz'</span>
<span class="variable">DB_SPLICEAI</span>=<span class="string">'/caminho/para/db/spliceai_scores.vcf.gz'</span>
<span class="variable">DB_NSFP</span>=<span class="string">'/caminho/para/db/dbNSFP_database.txt.gz'</span>

<span class="comment"># 4. Caminhos de entrada e sa√≠da</span>
<span class="variable">INPUT_VCF_DIR</span>=<span class="string">'/caminho/para/vcf_final/'</span>
<span class="variable">SAMPLE_NAME</span>=<span class="string">'cohort_genotyped_filtered_PASS'</span> <span class="comment"># Prefixo do arquivo VCF de entrada</span>
<span class="variable">OUTPUT_ANN_DIR</span>=<span class="string">'/caminho/para/salvar/anotacoes/'</span>

<span class="comment"># --- FIM DA CONFIGURA√á√ÉO ---</span>


<span class="comment"># --- L√ìGICA DO SCRIPT ORIGINAL (SEM ALTERA√á√ïES) ---</span>

<span class="keyword">echo</span> <span class="string">"Criando diret√≥rio de sa√≠da para anota√ß√µes..."</span>
<span class="command">mkdir</span> -p <span class="string">"$OUTPUT_ANN_DIR"</span>

<span class="keyword">echo</span> <span class="string">"Iniciando anota√ß√£o com SnpEff..."</span>
<span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPEFF_JAR"</span> -c <span class="string">"$SNPEFF_CONFIG"</span> -v <span class="string">"$GENOME_VERSION"</span> <span class="string">"${INPUT_VCF_DIR}/${SAMPLE_NAME}.vcf.gz"</span> > <span class="string">"${OUTPUT_ANN_DIR}/${SAMPLE_NAME}.snpeff.vcf"</span>

<span class="keyword">echo</span> <span class="string">"Iniciando pipeline de p√≥s-processamento e anota√ß√£o com SnpSift..."</span>
<span class="variable">snpeff_vcf</span>=<span class="string">"${OUTPUT_ANN_DIR}/${SAMPLE_NAME}.snpeff.vcf"</span>

<span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPSIFT_JAR"</span> filter <span class="string">"FILTER == 'PASS'"</span> <span class="string">"$snpeff_vcf"</span> \
    | <span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPEFF_JAR"</span> -canon -c <span class="string">"$SNPEFF_CONFIG"</span> -v <span class="string">"$GENOME_VERSION"</span> - \
    | <span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPSIFT_JAR"</span> dbnsfp -v -db <span class="string">"$DB_NSFP"</span> \
        -f <span class="string">"fathmm-MKL_coding_score,fathmm-MKL_coding_rankscore,FATHMM_score,FATHMM_converted_rankscore,VEST4_score,VEST4_rankscore,CADD_phred,SIFT_converted_rankscore,Polyphen2_HVAR_rankscore"</span> - \
    | <span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPSIFT_JAR"</span> annotate <span class="string">"$DB_CLINVAR"</span> - \
    | <span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPSIFT_JAR"</span> annotate <span class="string">"$DB_CLINVAR_COMMON"</span> - \
    | <span class="command">java</span> <span class="string">"$MEMORY"</span> -jar <span class="string">"$SNPSIFT_JAR"</span> annotate <span class="string">"$DB_SPLICEAI"</span> - \
    | <span class="command">perl</span> <span class="string">"$VCF_EFF_ONE_PER_LINE_PL"</span> \
    | <span class="command">sed</span> -e <span class="string">"s/\"PASS\"/$FILTER_PASS_VALUE/"</span> > <span class="string">"${OUTPUT_ANN_DIR}/cohort_annotated_final.vcf"</span>

<span class="keyword">echo</span> <span class="string">"Processo de anota√ß√£o conclu√≠do!"</span>
</code></pre>
            </div><br>
            <p><strong>üí° Importante!</strong> Configure as vari√°veis: edite a se√ß√£o de configura√ß√£o no topo do script para apontar para os diret√≥rios e arquivos corretos do seu projeto.</p><br>
          <p><strong>2 - </strong>Ap√≥s realizar a anota√ß√£o, devemos separar as amostras em arquivos separados. Para isso, execute o script a seguir:</p>
          <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">üìã</button>
          <pre><code>
<span class="comment"># --- CONFIGURA√á√ÉO: EDITE AS VARI√ÅVEIS ABAIXO ---</span>
<span class="comment"># ‚öôÔ∏è Modifique estas vari√°veis para se adequarem ao seu projeto.</span>

<span class="comment"># 1. Caminho para o arquivo VCF de entrada com m√∫ltiplas amostras.</span>
<span class="variable">INPUT_VCF</span>=<span class="string">"/caminho/para/seu/arquivo_multi_amostra.vcf.gz"</span>

<span class="comment"># 2. Diret√≥rio onde os VCFs individuais ser√£o salvos.</span>
<span class="variable">OUTPUT_DIR</span>=<span class="string">"/caminho/para/salvar/os/vcfs_individuais"</span>

<span class="comment"># --- FIM DA CONFIGURA√á√ÉO ---</span>


<span class="comment"># --- L√ìGICA DO SCRIPT (N√ÉO PRECISA EDITAR) ---</span>

<span class="comment"># Garante que o script pare se algum comando falhar.</span>
<span class="keyword">set</span> -e

<span class="keyword">echo</span> <span class="string">">>> Iniciando a separa√ß√£o do VCF por amostra..."</span>

<span class="comment"># Cria o diret√≥rio de sa√≠da, se ele n√£o existir.</span>
<span class="command">mkdir</span> -p <span class="string">"$OUTPUT_DIR"</span>

<span class="comment"># Loop para processar cada amostra encontrada no cabe√ßalho do VCF.</span>
<span class="keyword">for</span> <span class="variable">sample</span> <span class="keyword">in</span> <span class="operator">$(</span><span class="command">bcftools</span> query -l <span class="string">"$INPUT_VCF"</span><span class="operator">)</span>; <span class="keyword">do</span>
    
    <span class="keyword">echo</span> <span class="string">"--> Extraindo amostra: $sample"</span>
    
    <span class="comment"># Define o nome do arquivo de sa√≠da para a amostra atual.</span>
    <span class="variable">output_vcf</span>=<span class="string">"${OUTPUT_DIR}/${sample}_annotated.vcf"</span>
    
    <span class="comment"># Usa bcftools para criar um VCF contendo apenas a amostra atual.</span>
    <span class="command">bcftools</span> view -c 1 -s <span class="string">"$sample"</span> -o <span class="string">"$output_vcf"</span> <span class="string">"$INPUT_VCF"</span>
    
<span class="keyword">done</span>

<span class="keyword">echo</span> <span class="string">"‚úÖ Processo conclu√≠do! Os VCFs individuais foram salvos em: $OUTPUT_DIR"</span>
          </code></pre>
          </div><br>         
            
          <p><strong>3 - </strong>Agora, temos os arquivos vcf anotados, com todas as informa√ß√µes para fazermos as an√°lises. Por√©m alguns pacotes necessitam de formatos diferentes de arquivo, como o maftools. Caso voc√™ queira utilizar esse pacote, execute o script a seguir ainda no terminal do servidor:</p>
          <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">üìã</button>
          <pre><code>
<span class="comment">#!/bin/bash</span>

<span class="comment"># ===================================================================</span>
<span class="comment"># 1. DEFINI√á√ÉO DE VARI√ÅVEIS E CAMINHOS</span>
<span class="comment"># Configure os caminhos para as ferramentas e arquivos de refer√™ncia.</span>
<span class="comment"># ===================================================================</span>

<span class="comment"># Caminho para o genoma de refer√™ncia em formato FASTA</span>
<span class="variable">FASTA</span>=<b>'/CAMINHO/PARA/SEU/GENOMA_DE_REFERENCIA.fasta'</b>

<span class="comment"># Caminho para a pasta 'bin' da sua instala√ß√£o do VEP (Variant Effect Predictor)</span>
<span class="variable">VEP_PATH</span>=<b>'/CAMINHO/PARA/INSTALACAO/VEP/bin/'</b>

<span class="comment"># Caminho para o diret√≥rio de dados/cache do VEP</span>
<span class="variable">VEP_DATA</span>=<b>'/CAMINHO/PARA/DADOS_CACHE/VEP/'</b>

<span class="comment"># Vers√£o do cache do VEP que ser√° utilizada</span>
<span class="variable">VEP_VERSION</span>=112

<span class="comment"># Diret√≥rio contendo os arquivos VCF de entrada que ser√£o convertidos</span>
<span class="variable">DIR_ENTRADA_VCF</span>=<b>'/CAMINHO/PARA/SEUS/VCFs/DE/ENTRADA/'</b>

<span class="comment"># Diret√≥rio onde os arquivos MAF resultantes ser√£o salvos</span>
<span class="variable">DIR_SAIDA_MAF</span>=<b>'/CAMINHO/PARA/O/DIRETORIO/DE/SAIDA_MAF/'</b>


<span class="comment"># ===================================================================</span>
<span class="comment"># 2. PREPARA√á√ÉO DO AMBIENTE</span>
<span class="comment"># ===================================================================</span>

<span class="comment"># Cria o diret√≥rio de sa√≠da se ele ainda n√£o existir</span>
<span class="command">mkdir</span> -p ${<span class="variable">DIR_SAIDA_MAF</span>}

<span class="comment"># Navega para o diret√≥rio com os arquivos VCF de entrada</span>
<span class="command">cd</span> ${<span class="variable">DIR_ENTRADA_VCF</span>}


<span class="comment"># ===================================================================</span>
<span class="comment"># 3. EXECU√á√ÉO DA CONVERS√ÉO</span>
<span class="comment"># ===================================================================</span>

echo <span class="string">"Iniciando a convers√£o de VCF para MAF..."</span>

<span class="comment"># O loop itera sobre todos os arquivos que terminam com '_annotated_final.vcf'.</span>
<span class="comment"># Altere o padr√£o "*.vcf" se seus arquivos tiverem outro nome.</span>
<span class="command">for</span> i in *_annotated_final.vcf; <span class="command">do</span>
    echo <span class="string">"--------------------------------------------------"</span>
    echo <span class="string">"Processando arquivo: $i"</span>

    <span class="comment"># Extrai o nome da amostra a partir do nome do arquivo</span>
    <span class="variable">SAMPLE_NAME</span>=$(basename <span class="string">"$i"</span> | cut -d'.' -f1)
    <span class="variable">MAF_OUTPUT</span>=<span class="string">"${SAMPLE_NAME}.maf"</span>

    <span class="comment"># Este bloco extrai dinamicamente todos os campos INFO e FORMAT do VCF.</span>
    <span class="comment"># Isso garante que todas as anota√ß√µes presentes no VCF sejam mantidas no MAF final.</span>
    <span class="variable">fields</span>=$( \
        { \
            grep -oP <span class="string">'^##INFO=&lt;ID=\K[^,]+'</span> <span class="string">"$i"</span>; \
            grep -m1 -v <span class="string">'^#'</span> <span class="string">"$i"</span> | cut -f9 | tr ':' <span class="string">'\n'</span>; \
        } | uniq | paste -sd "," - \
    )

    <span class="comment"># Executa o script vcf2maf.pl</span>
    <span class="command">vcf2maf.pl</span> --input-vcf $i \
        --output-maf ${<span class="variable">DIR_SAIDA_MAF</span>}/${<span class="variable">MAF_OUTPUT</span>} \
        --ncbi-build GRCh38 \
        --ref-fasta ${<span class="variable">FASTA</span>} \
        --vep-path ${<span class="variable">VEP_PATH</span>} \
        --vep-data ${<span class="variable">VEP_DATA</span>} \
        --cache-version ${<span class="variable">VEP_VERSION</span>} \
        --vep-forks 12 \
        --tumor-id ${<span class="variable">SAMPLE_NAME</span>} \
        --vcf-tumor-id ${<span class="variable">SAMPLE_NAME</span>} \
        --retain-info ${<span class="variable">fields</span>}

    echo <span class="string">"Arquivo ${MAF_OUTPUT} gerado com sucesso em ${DIR_SAIDA_MAF}"</span>
<span class="command">done</span>

echo <span class="string">"--------------------------------------------------"</span>
echo <span class="string">"Convers√£o conclu√≠da!"</span>
          </code></pre>
          </div>
          </div>
        </div>
      </div>

      
      <!-- Pr√°tica 10 -->
      <div class="accordion-item border-0 shadow-sm rounded-3">
        <h2 class="accordion-header">
          <button class="accordion-button fw-semibold collapsed" type="button"
                  data-bs-toggle="collapse" data-bs-target="#collapseAtividade10"
                  aria-expanded="false" aria-controls="collapseAtividade10">
            Atividade 10 ‚Äî An√°lises
          </button>
        </h2>
        <div id="collapseAtividade10" class="accordion-collapse collapse" data-bs-parent="#accordionAtividades">
          <div class="accordion-body">
            <p><strong>Objetivo:</strong> Realizar an√°lises com os dados processados.</p><br>
            <p><strong>Tarefa:</strong> Explore o software <strong>R</strong> e seus pacotes para realizar an√°lises com os dados. Por exemplo, o pacote <a href="https://www.bioconductor.org/packages/release/bioc/html/maftools.html" target="_blank" rel="noopener"> maftools</a>
permite gerar <a href="https://bioconductor.org/packages/release/bioc/vignettes/maftools/inst/doc/oncoplots.html"> <strong>oncoplots</strong></a> e outras visualiza√ß√µes gen√¥micas.</p>
            <p><strong>‚ö†Ô∏è Agora utilize o software R!!</strong></p>
            <div class="code-container">
            <button class="copy-btn" onclick="copyCode(this)">üìã</button>
            <pre><code>
<span class="comment"># --- INSTALA√á√ÉO (executar apenas uma vez) ---</span>
<span class="comment"># if (!require("BiocManager", quietly = TRUE))</span>
<span class="comment">#     install.packages("BiocManager")</span>
<span class="comment"># BiocManager::install("maftools")</span>
              
<span class="function">library</span>(maftools)

<span class="comment"># Caminho para o arquivo MAF do TCGA LAML</span>
<span class="variable">laml.maf</span> = <span class="function">system.file</span>(<span class="string">'extdata'</span>, <span class="string">'tcga_laml.maf.gz'</span>, <span class="parameter">package</span> = <span class="string">'maftools'</span>)

<span class="comment"># Informa√ß√£o cl√≠nica contendo dados de sobrevida e histologia. Este passo √© opcional.</span>
<span class="variable">laml.clin</span> = <span class="function">system.file</span>(<span class="string">'extdata'</span>, <span class="string">'tcga_laml_annot.tsv'</span>, <span class="parameter">package</span> = <span class="string">'maftools'</span>)

<span class="variable">laml</span> = <span class="function">read.maf</span>(<span class="parameter">maf</span> = laml.maf,
                <span class="parameter">clinicalData</span> = laml.clin,
                <span class="parameter">verbose</span> = FALSE)

<span class="comment"># Por padr√£o, a fun√ß√£o plota os 20 genes mais mutados</span>
<span class="function">oncoplot</span>(<span class="parameter">maf</span> = laml, <span class="parameter">draw_titv</span> = TRUE)
</code></pre>
          </div><br>
          <p><strong>üí° Dica:</strong> Consulte a documenta√ß√£o do pacote para conhecer os tipos de gr√°ficos dispon√≠veis e as op√ß√µes de personaliza√ß√£o.</p>
                      
        </div>
      </div>
    </div>
  </section>

  <!-- Scripts -->
    <script>
              function copyCode(button) {
                const code = button.nextElementSibling.innerText;
                navigator.clipboard.writeText(code).then(() => {
                  button.innerText = '‚úÖ';
                  setTimeout(() => button.innerText = 'üìã', 1500);
                });
              }
    </script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Abre automaticamente a pr√°tica se houver hash na URL
    document.addEventListener("DOMContentLoaded", function () {
      const hash = window.location.hash;
      if (hash) {
        const target = document.querySelector(`#collapse${hash.replace("#atividade", "Atividade")}`);
        if (target) {
          const bsCollapse = new bootstrap.Collapse(target, { toggle: true });
          target.scrollIntoView({ behavior: "smooth", block: "start" });
        }
      }
    });
  </script>
</body>
</html>

















